# The following tasks are executed in the order they are declared
# Priorities are important, this ensure that this plugin is deployed after
# LMA Collector, InfluxDB and Elasticsearch.
- role: [primary-infrastructure_alerting, infrastructure_alerting]
  stage: post_deployment/8101
  type: puppet
  parameters:
    puppet_manifest: puppet/manifests/nagios.pp
    puppet_modules: puppet/modules
    timeout: 600

- role: [primary-infrastructure_alerting, infrastructure_alerting]
  stage: post_deployment/8101
  type: puppet
  parameters:
    puppet_manifest: puppet/manifests/ha_services.pp
    puppet_modules: puppet/modules
    timeout: 600

- role: [primary-infrastructure_alerting]
  stage: post_deployment/8101
  type: puppet
  parameters:
    puppet_manifest: puppet/manifests/nagios_dashboard_url.pp
    puppet_modules: puppet/modules
    timeout: 120
